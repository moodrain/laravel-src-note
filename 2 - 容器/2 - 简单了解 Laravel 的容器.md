### Laravel 容器的功能

* 简单绑定：绑定一个闭包、实例、类或者基本值，绑定闭包时可以传入容器实例，以解析其他依赖
* 传参解析：解析时可以通过 with 方法传入参数
* 上下文绑定：可以根据需要被注入的类，来决定注入什么服务
* 给绑定打标签：给服务打标签，方便管理批量注入
* 修饰绑定：传入一个闭包，在实际返回绑定的服务之前，可以再做处理
* 容器事件：可以监听指定绑定或者全局的，监听解析的前中后阶段的事件
* 数组访问：可以像访问数组一样访问 make 和 bind 

### 绑定
主要看 Container 类的 bind 方法
#### 1. 清理旧绑定
首先是清理旧的绑定（别名也要清理掉）
#### 2. 获取构造闭包
如果 $concrete (简称 $c) 参数没传，则默认与 $abstract （简称 $a） 相同； 如果已经是闭包了则绑定到 binding 数组中；如果是字符串则从容器中获得对象然后包装成闭包，如果 $a 和 $c 相同，则直接构造对象包装闭包，否则继续解析 $c
#### 3. 解析依赖
先触发容器事件，再检测是否在上下文中，再检测实例是否已经存在 instances 数组，如果存在则直接返回。继续检测需要的依赖是否在 binding 中注册了构造方法，如果有就将其取出为 $c。如果 $a 和 $c 相同或 $c 是闭包，则开始构造，否则继续解析 $c 依赖（重复此步骤）
#### 4. 构造
如果要构造的目标是一个闭包，那么带上参数直接执行这个闭包。否则通过反射来解析这个类，拿到构造函数和参数，依次从容器中解析各个参数，然后通过反射来新建这个类
#### 5. 完成绑定
获得构造闭包，再加上是否单例的属性 $shared，绑定到 binding 数组上。如果这个绑定已经存在过，那么再触发 rebound 事件

### 获取
主要看 Container 类的 resolve 方法，其实就是上一部分中的解析依赖